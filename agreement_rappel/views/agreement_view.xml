<?xml version="1.0"?>
<odoo>

    <record id="agreement_form" model="ir.ui.view">
        <field name="model">agreement</field>
        <field name="inherit_id" ref="agreement.agreement_form"/>
        <field name="arch" type="xml">
            <notebook position="inside">
                <page name="rappel" string="Rappel">
                    <group>
                        <group>
                            <field name="rappel_type"/>
                        </group>
                        <group>
                            <field name="rappel_discount" attrs="{'invisible': [('rappel_type', '!=', 'global')]}"/>
                        </group>
                    </group>
                    <group string="Lines" attrs="{'invisible': [('rappel_type', '=', False)]}">
                        <field name="rappel_line_ids" context="{'hide_rappel_discount': rappel_type != 'line'}" nolabel="1">
                            <tree string="Rappel Lines">
                                <field name="rappel_target"/>
                                <field name="rappel_domain" groups="base.group_no_one"/>
                                <field name="rappel_discount" attrs="{'column_invisible': [('parent.rappel_type', '!=', 'line')]}"/>
                            </tree>
                        </field>
                    </group>
                    <group string="Sections" attrs="{'invisible': [('rappel_type', 'not in', ['section_total', 'section_prorated'])]}">
                        <field name="rappel_section_ids" nolabel="1"/>
                    </group>
                </page>
            </notebook>
        </field>
    </record>

    <record id="agreement_rappel_line_tree" model="ir.ui.view">
        <field name="name">agreement.rappel.line.tree</field>
        <field name="model">agreement.rappel.line</field>
        <field name="arch" type="xml">
            <tree string="Rappel Lines">
                <field name="rappel_target"/>
                <field name="rappel_domain" groups="base.group_no_one"/>
                <field name="rappel_discount"/>
            </tree>
        </field>
    </record>

    <record id="agreement_rappel_line_form" model="ir.ui.view">
        <field name="name">agreement.rappel.line.form</field>
        <field name="model">agreement.rappel.line</field>
        <field name="arch" type="xml">
            <form string="Rappel Lines">
                <sheet>
                    <group>
                        <group>
                            <field name="rappel_target"/>
                        </group>
                        <group>
                            <field name="rappel_discount" invisible="context.get('hide_rappel_discount')"/>
                        </group>
                    </group>
                    <group string="Select items" col="1">
                        <field name="rappel_product_ids" widget="many2many_tags"
                               attrs="{'invisible': [('rappel_target', '!=', 'product')]}" nolabel="1"/>
                        <field name="rappel_product_tmpl_ids" widget="many2many_tags"
                               attrs="{'invisible': [('rappel_target', '!=', 'product_tmpl')]}" nolabel="1"/>
                        <field name="rappel_category_ids" widget="many2many_tags"
                               attrs="{'invisible': [('rappel_target', '!=', 'category')]}" nolabel="1"/>
                        <field name="rappel_condition_id"
                               attrs="{'invisible': [('rappel_target', '!=', 'condition')]}" nolabel="1"/>
                        <field name="rappel_domain" widget="domain"
                               options="{'model': 'account.invoice.line'}"
                               attrs="{'invisible': [('rappel_target', '!=', 'domain')]}" nolabel="1"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="agreement_rappel_section_tree" model="ir.ui.view">
        <field name="name">agreement.rappel.section.tree</field>
        <field name="model">agreement.rappel.section</field>
        <field name="arch" type="xml">
            <tree string="Rappel Sections" editable="bottom">
                <field name="amount_from"/>
                <field name="amount_to"/>
                <field name="rappel_discount"/>
            </tree>
        </field>
    </record>

</odoo>
