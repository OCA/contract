<?xml version="1.0" encoding="utf-8" ?>
<!-- Copyright 2021 ACSONE SA/NV
     License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl). -->
<odoo>
    <template
        id="report_contract_document"
        inherit_id="contract.report_contract_document"
    >

        <xpath expr="//tbody//t[@t-if='not l.display_type']" position="attributes">
            <attribute
                name="t-if"
                add="(not current_section or current_section.show_details)"
                separator=" and "
            />
        </xpath>

        <xpath
            expr='//tbody//t[@t-if="l.display_type == &apos;line_section&apos;"]//td'
            position="attributes"
        >
            <attribute name="t-if" add="l.show_details" separator=" and " />
        </xpath>

        <xpath
            expr='//tbody//t[@t-if="l.display_type == &apos;line_note&apos;"]//td'
            position="attributes"
        >
            <attribute
                name="t-if"
                add="(not current_section or current_section.show_details)"
                separator=" and "
            />
        </xpath>
        <xpath
            expr="//tbody//tr[hasclass('is-subtotal', 'text-right')]"
            position="attributes"
        >
            <attribute
                name="t-if"
                add="current_section.show_details and current_section.show_subtotal"
                separator=" and "
            />
        </xpath>
        <xpath
            expr="//tbody//tr[hasclass('is-subtotal', 'text-right')]/td/strong"
            position="attributes"
        >
            <attribute name="class" add="d-none" separator=" " />
        </xpath>
        <xpath
            expr="//tbody//tr[hasclass('is-subtotal', 'text-right')]/td/strong"
            position="after"
        >
            <strong class="mr16">Subtotal</strong>
        </xpath>
        <xpath
            expr="//tbody//tr[hasclass('is-subtotal', 'text-right')]"
            position="after"
        >
            <t t-if="not current_section.show_details">
                <tr class="bg-200 o_line_section">
                    <td colspan="99">
                        <span t-field="current_section.name" class="font-weight-bold" />
                        <span class="float-right">
                            <span
                                class="float-right"
                                t-esc="current_subtotal"
                                t-options='{"widget": "monetary", "display_currency": o.pricelist_id.currency_id}'
                            />
                            <t t-set="total" t-value="total + current_subtotal" />
                        </span>
                    </td>
                </tr>
            </t>
        </xpath>
        <xpath expr="//td/span[@t-field='l.price_unit']" position="attributes">
            <attribute
                name="t-if"
                add="not current_section or current_section.show_line_amount"
                separator=" and "
            />
        </xpath>
        <xpath expr="//td/span[@t-field='l.price_subtotal']" position="attributes">
            <attribute
                name="t-if"
                add="not current_section or current_section.show_line_amount"
                separator=" and "
            />
        </xpath>

    </template>
</odoo>
